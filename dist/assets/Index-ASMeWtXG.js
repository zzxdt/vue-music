import{Q as q,j as a,k as l,U as G,V as H,l as r,d as E,F as c,C as f,m as u,z as S,i as O,v as M,q as I,al as J,X as $,y as z,x as B,D as _,Y as Q,R as X,G as Y,r as W,o as Z,a1 as x,J as ee,$ as F,am as te,ak as se,s as ae,an as ne,ao as oe}from"./index-nvWmsnf9.js";import{_ as A}from"./MvList-m_0rPA1e.js";import{_ as R}from"./PlayList-_u7cpBFH.js";import{_ as D}from"./AlbumList-AuCPDn1s.js";import{_ as N}from"./Loading-KSf3ufRB.js";import{_ as P}from"./ArtistItem-ZWtLqh1L.js";import"./el-skeleton-item-kIwtNASk.js";const le={},j=t=>(G("data-v-bc7b46e6"),t=t(),H(),t),ie={class:"empty"},re=j(()=>r("i",{class:"iconfont icon-empty"},null,-1)),ue=j(()=>r("p",null,"暂无结果",-1)),pe=[re,ue];function de(t,i,p,e,h,k){return a(),l("div",ie,pe)}const K=q(le,[["render",de],["__scopeId","data-v-bc7b46e6"]]),ce=E({name:"searchArtist",props:{list:{type:Array,required:!0},loading:{type:Boolean,default:!1}},components:{Loading:N,ArtistItem:P}}),me={class:"list-container"};function ye(t,i,p,e,h,k){const m=P,y=N;return a(),l("div",me,[(a(!0),l(c,null,f(t.list,g=>(a(),u(m,{item:g},null,8,["item"]))),256)),t.loading?(a(),u(y,{key:0})):S("",!0)])}const ge=q(ce,[["render",ye],["__scopeId","data-v-012b9f96"]]),_e=E({name:"SearchDetail",setup(){const t=Q(),i=X(),{proxy:p}=Y(),e=W({keyVal:t.query.key,type:t.query.type||"1",typeList:[{k:1,v:"单曲",t:"首单曲"},{k:10,v:"专辑",t:"张专辑"},{k:100,v:"歌手",t:"个歌手"},{k:1e3,v:"歌单",t:"个歌单"},{k:1004,v:"MV",t:"个MV"}],index:0,total:0,offset:0,limit:24,list:[],currentpage:0,loading:!1,listType:{songs:"单曲",artists:"歌手",albums:"专辑",playlists:"歌单"},suggestInfo:[]}),h=s=>{e.keyVal=s,e.keyVal&&(e.loading=!0,e.suggestInfo=[],v())},k=()=>{console.log(e.keyVal),e.keyVal&&(e.loading=!0,e.suggestInfo=[],v())},m=async()=>{e.loading=!0;const{data:s}=await p.$http.cloudsearch({keywords:e.keyVal,type:e.type,limit:e.limit,offset:e.offset});if(s.code!==200)return p.$msg.error("数据请求失败");e.type==="1"?(e.list=s.result.songs&&s.result.songs.map(n=>({id:String(n.id),name:n.name,mvId:n.mv,singer:n.ar,album:n.al,alia:n.alia,vip:n.fee===1,license:n.license,duration:p.$utils.formatSongTime(n.dt),url:`https://music.163.com/song/media/outer/url?id=${n.id}.mp3`,publishTime:p.$utils.formatMsgTime(n.publishTime)})),e.total=s.result.songCount||0):e.type==="10"?(e.list=s.result.albums||[],e.total=s.result.albumCount||0):e.type==="100"?(e.list=s.result.artists||[],e.total=s.result.artistCount||0):e.type==="1000"?(e.list=s.result.playlists||[],e.total=s.result.playlistCount||0):e.type==="1004"?(e.list=s.result.mvs||[],e.total=s.result.mvCount||0):e.type==="1014"&&(e.list=s.result.videos||[],e.total=s.result.videoCount||0),e.loading=!1},y=s=>{e.type=s.k,e.total=0,e.offset=0,e.currentpage=0,i.push({path:"/search",query:{key:e.keyVal,type:e.type}})},g=s=>{e.offset=(s-1)*e.limit,e.currentpage=s,m()},v=async()=>{const{data:s}=await p.$http.serachSuggest({keywords:e.keyVal});if(e.loading=!1,s.code!==200)return p.$msg.error("数据请求失败");s.result.order&&(e.suggestInfo=s.result.order.map(n=>({label:n,info:s.result[n]})))},C=(s,n)=>{switch(n){case"songs":i.push({path:"/song",query:{id:s.id}});break;case"artists":i.push({path:"/singer",query:{id:s.id}});break;case"albums":i.push({path:"/album",query:{id:s.id}});break;case"playlists":i.push({path:"/playlist/detail",query:{id:s.id}});break}},V=()=>{e.suggestInfo=[]},L=()=>{i.push({path:"/search",query:{key:e.keyVal,type:e.type}})},b=()=>{e.total=0,e.list=[],m()};return Z(()=>{e.index=e.typeList.findIndex(s=>s.k==e.type),b()}),x(s=>{e.keyVal=s.query.key,e.type=s.query.type||"1",e.index=e.typeList.findIndex(n=>n.k==e.type),b()}),{...ee(e),selectType:y,currentChange:g,remoteMethod:h,handleFocus:k,jumpPage:C,clearVal:V,enterHandler:L}},components:{SongList:F,AlbumList:D,SearchArtist:ge,PlayList:R,MvList:A,Empty:K}}),fe={class:"search-detail"},he={class:"search-container"},ke={class:"search-hd"},ve={class:"artists"},be={class:"search-main"},$e={class:"search-tab"},Ce=["onClick"],Ve={key:0,class:"search-list"},Le={class:"pagination"};function Ie(t,i,p,e,h,k){const m=ne,y=oe,g=te,v=F,C=D,V=O("search-artist"),L=R,b=A,s=K,n=se;return a(),l("div",fe,[r("div",he,[r("div",ke,[M(g,{modelValue:t.keyVal,"onUpdate:modelValue":i[0]||(i[0]=o=>t.keyVal=o),class:"search-box",clearable:"",filterable:"",remote:"",placeholder:"请输入歌名、歌词、歌手或专辑","remote-method":t.remoteMethod,"fit-input-width":!0,loading:t.loading,"loading-text":"搜索中...",onFocus:t.handleFocus,onClear:t.clearVal,onKeyup:J(t.enterHandler,["enter"])},{default:I(()=>[(a(!0),l(c,null,f(t.suggestInfo,o=>(a(),u(y,{key:t.listType[o.label],label:t.listType[o.label]},{default:I(()=>[(a(!0),l(c,null,f(o.info,(d,U)=>(a(),u(m,{key:o.label+U,label:d.name,value:o.label+d.name,class:"item",onClick:w=>t.jumpPage(d,o.label)},{default:I(()=>[$(_(d.name)+" ",1),o.label==="songs"?(a(),l(c,{key:0},[$(" - "),(a(!0),l(c,null,f(d.artists,(w,T)=>(a(),l("span",{class:"artists",key:T},_((T!==0?" / ":"")+w.name),1))),128))],64)):o.label==="albums"?(a(),l(c,{key:1},[$(" - "),r("span",ve,_(d.artist.name),1)],64)):S("",!0)]),_:2},1032,["label","value","onClick"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","remote-method","loading","onFocus","onClear","onKeyup"])]),r("div",be,[r("h5",null,[$("搜索结果"),z(r("em",null,"("+_(t.total+t.typeList[t.index].t)+")",513),[[B,t.total]])]),r("div",$e,[(a(!0),l(c,null,f(t.typeList,o=>(a(),l("div",{class:ae(["tab-item",{active:t.type==o.k}]),key:o.k,onClick:d=>t.selectType(o)},_(o.v),11,Ce))),128))]),t.total||t.loading?(a(),l("div",Ve,[t.type=="1"?(a(),u(v,{key:0,songList:t.list,stripe:!0,offset:t.offset,pageSize:t.limit},null,8,["songList","offset","pageSize"])):t.type=="10"?(a(),u(C,{key:1,class:"albums",albumList:t.list,loading:t.loading,num:t.limit},null,8,["albumList","loading","num"])):t.type=="100"?(a(),u(V,{key:2,list:t.list,loading:t.loading},null,8,["list","loading"])):t.type==="1000"?(a(),u(L,{key:3,class:"play",playList:t.list,loading:t.loading,num:t.limit},null,8,["playList","loading","num"])):t.type==="1004"?(a(),u(b,{key:4,mvList:t.list,loading:t.loading,num:t.limit},null,8,["mvList","loading","num"])):S("",!0)])):(a(),u(s,{key:1})),z(r("div",Le,[M(n,{onCurrentChange:t.currentChange,"current-page":t.currentpage,"page-size":t.limit,layout:"prev, pager, next",total:t.total},null,8,["onCurrentChange","current-page","page-size","total"])],512),[[B,t.total>t.limit]])])])])}const Ee=q(_e,[["render",Ie],["__scopeId","data-v-48d885a9"]]);export{Ee as default};
