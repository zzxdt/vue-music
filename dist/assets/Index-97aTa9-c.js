import{Q as T,$ as q,G as B,W as M,Y as V,r as z,o as E,a1 as U,J as R,i as w,j as r,k as m,l as s,v as p,q as b,X as d,D as l,F as D,C,z as _,s as $,S as F,m as L,U as P,V as Y}from"./index-nvWmsnf9.js";import{C as j}from"./Comments-AlU7rqLJ.js";const G={name:"albumDetail",components:{SongList:q,CommentList:j},setup(e){const{proxy:o}=B(),g=M(),c=V(),t=z({albumId:"",details:null,songList:[],dynamic:{},hotAlbums:[],comments:[],type:3,isShowDesc:!1,collects:[]}),A=async i=>{const{data:n}=await o.$http.album(i);if(n.code!==200)return o.$msg.error("数据请求失败");t.details=n.album;const k=[];n.songs.forEach(N=>{k.push(N.privilege)}),t.songList=o.$utils.formatSongs(n.songs,k),u()},h=async i=>{const{data:n}=await o.$http.albumDynamic(i);if(n.code!==200)return o.$msg.error("数据请求失败");t.dynamic=n},u=async()=>{const{data:i}=await o.$http.artistAlbum({id:t.details.artists[0].id,limit:5});if(i.code!==200)return o.$msg.error("数据请求失败");t.hotAlbums=i.hotAlbums},f=()=>{t.details.description.length>120&&(t.isShowDesc=!t.isShowDesc)},v=()=>{g.dispatch("playAll",{list:t.songList}),g.commit("SET_PLAYLISTTIPS",!0)},a=async()=>{const{data:i}=await o.$http.albumSub({id:t.albumId,t:+!t.dynamic.isSub});if(i.code!==200)return o.$msg.error("数据请求失败");t.dynamic.isSub=+!t.dynamic.isSub},S=async i=>{const{data:n}=await o.$http.playlistSCollect(i);if(n.code!==200)return o.$msg.error("数据请求失败");t.collects=n.subscribers},I=()=>{A({id:t.albumId}),h({id:t.albumId}),S({id:t.albumId})};return E(()=>{t.albumId=c.query.id,I()}),U(i=>{t.albumId=i.query.id,I()}),{...R(t),showAllDesc:f,playAllSongs:v,subAlbum:a}}},y=e=>(P("data-v-89410644"),e=e(),Y(),e),J={key:0,class:"album"},Q={class:"detail-container"},W={class:"detail-main"},X={class:"album-cover"},H={class:"album-img"},K=y(()=>s("div",{slot:"placeholder",class:"image-slot"},[s("i",{class:"iconfont icon-placeholder"})],-1)),O={class:"album-info"},Z={class:"album-title"},x={class:"album-singer"},ss={class:"album-time"},es={class:"album-company"},ts={key:0,class:"album-desc"},os=y(()=>s("i",{class:"iconfont icon-closed"},null,-1)),as=[os],is={key:0,class:"album-desc-all"},ls={class:"song-main"},ns={class:"song-header"},ds=y(()=>s("i",{class:"iconfont icon-audio-play"},null,-1)),cs={class:"album-comments",ref:"comment"},rs={class:"aside-box"},ms={class:"album-aside album-other"},us={class:"aside-title"},ps={class:"aside-main aside-album-main"},bs=y(()=>s("div",{slot:"placeholder",class:"image-slot"},[s("i",{class:"iconfont icon-placeholder"})],-1)),hs={class:"aside-album-info"},_s={class:"aside-album-name"},ys={class:"aside-album-time"};function gs(e,o,g,c,t,A){const h=F,u=w("router-link"),f=q,v=w("comment-list");return e.details?(r(),m("div",J,[s("div",Q,[s("div",W,[s("div",X,[s("div",H,[p(h,{src:e.details.picUrl},{default:b(()=>[K]),_:1},8,["src"])]),s("div",O,[s("div",Z,[d(l(e.details.name)+" ",1),s("span",null,l("#"+e.details.type),1)]),s("div",x,[d("歌手："),(r(!0),m(D,null,C(e.details.artists,(a,S)=>(r(),L(u,{to:{path:"/singer",query:{id:a.id}},class:"song_name",key:a.name},{default:b(()=>[d(l(S!==0?" / "+a.name:a.name),1)]),_:2},1032,["to"]))),128))]),s("div",ss,"发行时间："+l(e.$utils.formartDate(e.details.publishTime,"yyyy-MM-dd")),1),s("div",es,"发行公司："+l(e.details.company),1),e.details.description?(r(),m("div",ts,[s("h5",null,[d("歌单简介"),e.isShowDesc?(r(),m("em",{key:0,class:"desc-close",onClick:o[0]||(o[0]=a=>e.isShowDesc=!1)},as)):_("",!0)]),s("p",{onClick:o[1]||(o[1]=(...a)=>c.showAllDesc&&c.showAllDesc(...a))},l(e.details.description),1),e.isShowDesc?(r(),m("pre",is,"                                "+l(e.details.description)+`
                            `,1)):_("",!0)])):_("",!0)])]),s("div",ls,[s("div",ns,[s("h4",null,[d("包含歌曲列表 "),s("em",null,l(e.details.size+"首歌"),1)]),s("span",{class:"play-all",onClick:o[2]||(o[2]=(...a)=>c.playAllSongs&&c.playAllSongs(...a))},[ds,d(" 播放全部")]),s("span",{class:$(["collect",e.dynamic.isSub?"active":""]),onClick:o[3]||(o[3]=(...a)=>c.subAlbum&&c.subAlbum(...a))},[s("i",{class:$(["iconfont","icon-collect"+(e.dynamic.isSub?"-active":"")])},null,2),d(" "+l(e.dynamic.isSub?"已收藏":"收藏"),1)],2)]),p(f,{songList:e.songList,stripe:!0},null,8,["songList"])]),s("div",cs,[p(v,{type:e.type,sId:e.albumId},null,8,["type","sId"])],512)]),s("div",rs,[s("div",ms,[s("h3",us,[d(l(e.details.artists[0].name)+"的其他专辑",1),p(u,{to:{path:"/singer",query:{id:e.details.artists[0].id,type:"album"}},class:"album-more"},{default:b(()=>[d("全部>>")]),_:1},8,["to"])]),s("div",ps,[(r(!0),m(D,null,C(e.hotAlbums,a=>(r(),L(u,{class:"aside-album-item",to:{path:"/album",query:{id:a.id}},key:a.id},{default:b(()=>[p(h,{src:a.picUrl},{default:b(()=>[bs]),_:2},1032,["src"]),s("div",hs,[s("div",_s,l(a.name),1),s("div",ys,l(e.$utils.formartDate(e.details.publishTime,"yyyy-MM-dd")),1)])]),_:2},1032,["to"]))),128))])])])])])):_("",!0)}const Ss=T(G,[["render",gs],["__scopeId","data-v-89410644"]]);export{Ss as default};
